# RtD :card_file_box:

[Read in English](README.md)

# Зачем?

В списке аниме на Shikimori можно добавлять комментарии к тайтлам. Однако лимит символов - 4067.  
Проект создан для того, чтобы можно было добавлять собственные развёрнутые комментарии к тайтлам без необходимости где-то их публиковать.  
Просто запускайте `.exe` время от времени, чтобы получить свежую информацию о тайтлах. Можно искать по жанрам и читать описание тайтла с Shikimori (в будущем могут быть добавлены дополнительные функции) в приложении Obsidian.

# Как это работает?

- Запускается `RtD.exe`
- `RtD.exe` использует файл `rtd_config.json` для конфигурации, либо  
Вы вручную вводите путь к папке, куда будут помещены `.md` файлы  
А также свой `userId` на Shikimori  
- Затем загружается база данных и выполняются API-запросы
- Все тайтлы из списка добавляются в указанную папку
- Структура файлов выглядит так:
  

> :open_file_folder: Корневая папка  
> > :open_file_folder: Папка с названием тайтла  
> > > :page_facing_up: Файл с названием тайтла и расширением `.md`  
  
  
:page_facing_up: Содержимое Markdown файла:
```
---
YAML блок
---

# Review

текст, полученный из списка аниме (комментарий, который добавлялся к тайтлу на сайте)

PrivateMarker
Личные комментарии (всё, что идёт после PrivateMarker, сохраняется при обновлении)

```
  
`PrivateMarker` нужен для того, чтобы при повторной загрузке списка личные комментарии не удалялись.  

### :page_with_curl: rtd_config.json

Можно создать необязательный конфигурационный файл, чтобы не вводить данные вручную каждый раз.  
`rtd_config.json` должен находиться в той же папке, что и `RtD.exe`.  

Пример содержимого `rtd_config.json`:
```json
{
    "AutomaticAppExecution": true,
    "RootPath": "C:\\Anime",
    "UserId": "0000000"
}
```

- `AutomaticAppExecution` — Значение `true`, чтобы программа использовала файл конфигурации (`rtd_config.json`). Если установить `false`, программа будет спрашивать путь и ID при каждом запуске.
- `RootPath` — путь к папке, где будут сохраняться `.md` файлы.
- `UserId` — ID на Shikimori.

### \:floppy_disk: anime_cache.db

При запуске программы (если файл отсутствует) создаётся `anime_cache.db`.  
Этот файл содержит кэшированные значения `anime_id`, `updatedAt` и `folder_name`.
  
> \[!CAUTION]
> `anime_cache.db` — очень важный файл. Не теряйте его!
  
# Информация о сборке
  
Проект собран с использованием .NET Core 9 и Visual Studio 2022 (v17+)  
  
## Как собрать?
  
- Склонируй репозиторий
- Установи пакет .NET Framework для Visual Studio (см. `RtD.csproj`), либо используй любую другую подходящую среду
- Собери и запусти код
  
### Дополнительная информация
  
Операции с файлами и API-запросы выполняются пакетами по 50 элементов (см. значение `limit`).  
Это связано с тем, что API ограничен 50 тайтлами за один запрос.  
Это правило применяется:
  
- при полной повторной загрузке списка
- если программа не запускалась долгое время и список сильно изменился
- если файл `anime_cache.db` отсутствует
  
При переносе файлов **обязательно** вместе с `RtD.exe` перемещате `rtd_config.json`, и особенно - `anime_cache.db`.
Без этих файлов придётся снова вводить путь и `userId`, а также повторно загружать весь список через API.